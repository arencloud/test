- name: Wait for system to become reachable
  ansible.builtin.wait_for_connection:
    timeout: "{{ pause_timer }}"

- name: Identifying VM OS
  ansible.builtin.set_fact:
    os_info: "windows"
  when: "'windows' in vm_os[0]"

- name: Identifying VM OS
  ansible.builtin.set_fact:
    os_info: "linux"
  when: "'linux' in vm_os[0]"

- name: "Check {{ vm_os }} virtual machines availability after migration"
  ansible.builtin.include_tasks: "{{ os_info }}.yml"

- name: Obtain SSO token
  ovirt.ovirt.ovirt_auth:
    insecure: true

- name: Set comment
  ovirt.ovirt.ovirt_vm:
    auth: "{{ ovirt_auth }}"
    id: "{{ item.id }}"
    comment: "{{ message }}"
  loop: "{{ vm_ids }}"
